# SQL Agent æ•°æ®åˆ†æç³»ç»Ÿ

åŸºäº LangChain 1.0 å’Œ RAG æŠ€æœ¯çš„è‡ªç„¶è¯­è¨€è½¬ SQL æ™ºèƒ½æ•°æ®åˆ†æç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **AI é©±åŠ¨çš„ SQL ç”Ÿæˆ**ï¼šé€šè¿‡è‡ªç„¶è¯­è¨€é—®é¢˜è‡ªåŠ¨ç”Ÿæˆ SQL æŸ¥è¯¢
- ğŸ“Š **æ•°æ®å¯è§†åŒ–**ï¼šè‡ªåŠ¨ç”Ÿæˆå›¾è¡¨å±•ç¤ºæŸ¥è¯¢ç»“æœ
- ğŸ“ **RAG è®­ç»ƒæ•°æ®ç®¡ç†**ï¼šæ”¯æŒ SQL ç¤ºä¾‹ã€DDL ç»“æ„ã€è¡¨æ–‡æ¡£çš„å¢åˆ æŸ¥æ”¹
- ğŸ’¬ **æ™ºèƒ½å¯¹è¯**ï¼šæ”¯æŒå¤šè½®å¯¹è¯ï¼Œç†è§£ä¸Šä¸‹æ–‡
- ğŸ” **å®æ—¶æŸ¥è¯¢**ï¼šå³æ—¶æ‰§è¡Œ SQL å¹¶å±•ç¤ºç»“æœ
- ğŸ“ˆ **æ•°æ®åˆ†ææŠ¥å‘Š**ï¼šè‡ªåŠ¨ç”Ÿæˆæ•°æ®æ´å¯Ÿå’Œåˆ†æå»ºè®®

## æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: FastAPI
- **LLM**: OpenAI API (å…¼å®¹æ ¼å¼)
- **å‘é‡æ•°æ®åº“**: Milvus
- **åµŒå…¥æ¨¡å‹**: Jina Embeddings
- **æ•°æ®åº“**: MySQL
- **Agent**: LangChain 1.0 + LangGraph

### å‰ç«¯
- **æ¡†æ¶**: React + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **UI ç»„ä»¶**: shadcn/ui + Tailwind CSS
- **å›¾è¡¨**: Chart.js
- **è·¯ç”±**: React Router

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.13.5
- Node.js 18+
- MySQL 8.0+
- Milvus 2.4+
- Conda (Miniconda/Anaconda)

### ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
./start_all.sh

# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop_all.sh
```

### æ‰‹åŠ¨å¯åŠ¨

#### 1. å¯åŠ¨ä¸­é—´ä»¶æœåŠ¡

**Jina Embedding æœåŠ¡**
```bash
cd local_embedding
conda activate jina_run
MODEL_DIR=./jina-embeddings-v4-vllm-retrieval python -m uvicorn app_jina_embedding_v4:app --host 0.0.0.0 --port 8898
```

**Milvus æœåŠ¡**
```bash
cd milvus-deployment/milvus_server
./start_milvus.sh
```

#### 2. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend/vanna
conda activate nl2sqlagent
python api_server.py
```

#### 3. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd frontend
node ./node_modules/vite/bin/vite.js --host 0.0.0.0 --port 3000
```

### æœåŠ¡åœ°å€

| æœåŠ¡ | åœ°å€ |
|------|------|
| å‰ç«¯ | http://localhost:3000 |
| åç«¯ API | http://localhost:8100 |
| API æ–‡æ¡£ | http://localhost:8100/docs |
| Jina Embedding | http://localhost:8898 |
| Milvus | http://localhost:19530 |

## é¡¹ç›®ç»“æ„

```
06_LangChainSqlAgent/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ vanna/
â”‚       â”œâ”€â”€ api_server.py          # FastAPI æœåŠ¡å…¥å£
â”‚       â”œâ”€â”€ react_agent.py         # Agent ä¸»ç¨‹åº
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ Improve/
â”‚               â”œâ”€â”€ agent/         # Agent æ ¸å¿ƒé€»è¾‘
â”‚               â”œâ”€â”€ clients/       # å®¢æˆ·ç«¯ï¼ˆVanna, Embeddingï¼‰
â”‚               â””â”€â”€ middleware/    # æ—¥å¿—å’Œè¿½è¸ªä¸­é—´ä»¶
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ Dashboard.tsx      # ä¸»é¢æ¿
â”‚       â”‚   â”œâ”€â”€ ChatPanel.tsx      # AI å¯¹è¯é¢æ¿
â”‚       â”‚   â”œâ”€â”€ QueryPanel.tsx     # SQL ç¼–è¾‘å™¨
â”‚       â”‚   â”œâ”€â”€ ResultsPanel.tsx   # ç»“æœå±•ç¤º
â”‚       â”‚   â””â”€â”€ TrainingDataPanel.tsx  # è®­ç»ƒæ•°æ®ç®¡ç†
â”‚       â””â”€â”€ pages/
â”‚           â””â”€â”€ Home.tsx           # é¦–é¡µ
â””â”€â”€ README.md
```

## ä½¿ç”¨è¯´æ˜

### 1. æ•°æ®æºé…ç½®

åœ¨å·¦ä¾§"æ•°æ®æº"æ ‡ç­¾ä¸­æŸ¥çœ‹å·²è¿æ¥çš„æ•°æ®åº“è¡¨ã€‚

### 2. è®­ç»ƒæ•°æ®ç®¡ç†

åˆ‡æ¢åˆ°"è®­ç»ƒæ•°æ®"æ ‡ç­¾ï¼š
- æ·»åŠ  SQL æŸ¥è¯¢ç¤ºä¾‹ï¼ˆé—®é¢˜ + SQL è¯­å¥ï¼‰
- æ·»åŠ  DDL è¡¨ç»“æ„å®šä¹‰
- æ·»åŠ è¡¨æ–‡æ¡£è¯´æ˜

### 3. AI å¯¹è¯æŸ¥è¯¢

åœ¨å³ä¾§å¯¹è¯é¢æ¿ä¸­ï¼š
1. è¾“å…¥è‡ªç„¶è¯­è¨€é—®é¢˜
2. AI è‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œ SQL
3. æŸ¥çœ‹æŸ¥è¯¢ç»“æœå’Œå¯è§†åŒ–å›¾è¡¨
4. è·å–æ•°æ®åˆ†ææŠ¥å‘Š

### 4. SQL æ‰‹åŠ¨ç¼–è¾‘

åœ¨ä¸­é—´ SQL ç¼–è¾‘å™¨ä¸­ï¼š
- æ‰‹åŠ¨ç¼–å†™æˆ–ä¿®æ”¹ SQL
- ç‚¹å‡»æ‰§è¡ŒæŒ‰é’®æŸ¥è¯¢
- æŸ¥çœ‹ç»“æœè¡¨æ ¼

## æ ¸å¿ƒåŠŸèƒ½

### RAG å¢å¼º

ç³»ç»Ÿä½¿ç”¨ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ï¼š
- ä»å‘é‡æ•°æ®åº“æ£€ç´¢ç›¸ä¼¼çš„ SQL ç¤ºä¾‹
- æ£€ç´¢ç›¸å…³çš„è¡¨ç»“æ„å’Œæ–‡æ¡£
- æå‡ SQL ç”Ÿæˆçš„å‡†ç¡®åº¦

### Agent å·¥ä½œæµ

1. ç”¨æˆ·æé—®
2. æ£€ç´¢ç›¸å…³è®­ç»ƒæ•°æ®ï¼ˆRAGï¼‰
3. ç†è§£é—®é¢˜æ„å›¾
4. ç”Ÿæˆ SQL æŸ¥è¯¢
5. éªŒè¯ SQL è¯­æ³•
6. æ‰§è¡ŒæŸ¥è¯¢
7. åˆ†æç»“æœ
8. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
9. è¿”å›åˆ†ææŠ¥å‘Š

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## å¼€æºåè®®

**éå•†ä¸šä½¿ç”¨è®¸å¯è¯**
ç‰ˆæƒæ‰€æœ‰ (c) 2026 sgerpguochao

æœ¬é¡¹ç›®ä»…é™ä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ•™è‚²ç›®çš„ä½¿ç”¨ï¼Œç¦æ­¢ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚

è¯¦ç»†å†…å®¹è¯·æŸ¥çœ‹ [LICENSE](./LICENSE) æ–‡ä»¶ã€‚

## è”ç³»æ–¹å¼

- GitHub: https://github.com/sgerpguochao/SQLAgent_Vanna
